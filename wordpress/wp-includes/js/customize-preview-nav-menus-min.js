wp.customize.navMenusPreview=wp.customize.MenusCustomizerPreview=function(a,l,e,v){"use strict";var i={data:{navMenuInstanceArgs:{}}};return"undefined"!=typeof _wpCustomizePreviewNavMenusExports&&l.extend(i.data,_wpCustomizePreviewNavMenusExports),i.init=function(){var n=this,t=!1;v.preview.bind("sync",function(){t=!0}),v.selectiveRefresh&&(v.each(function(e){n.bindSettingListener(e)}),v.bind("add",function(e){e.get()&&!e.get()._invalid&&n.bindSettingListener(e,{fire:t})}),v.bind("remove",function(e){n.unbindSettingListener(e)}),v.selectiveRefresh.bind("render-partials-response",function(e){e.nav_menu_instance_args&&l.extend(n.data.navMenuInstanceArgs,e.nav_menu_instance_args)})),v.preview.bind("active",function(){n.highlightControls()})},v.selectiveRefresh&&(i.NavMenuInstancePartial=v.selectiveRefresh.Partial.extend({initialize:function(e,n){var t=this,a,i;if(!(a=e.match(/^nav_menu_instance\[([0-9a-f]{32})]$/)))throw new Error("Illegal id for nav_menu_instance partial. The key corresponds with the args HMAC.");if(i=a[1],(n=n||{}).params=l.extend({selector:'[data-customize-partial-id="'+e+'"]',navMenuArgs:n.constructingContainerContext||{},containerInclusive:!0},n.params||{}),v.selectiveRefresh.Partial.prototype.initialize.call(t,e,n),!l.isObject(t.params.navMenuArgs))throw new Error("Missing navMenuArgs");if(t.params.navMenuArgs.args_hmac!==i)throw new Error("args_hmac mismatch with id")},isRelatedSetting:function(e,n,t){var a=this,i,r,s,o,u,c;if(l.isString(e)&&(e=v(e)),(s=/^nav_menu_item\[/.test(e.id))&&l.isObject(n)&&l.isObject(t)&&(o=l.clone(n),u=l.clone(t),delete o.type_label,delete u.type_label,"https"===v.preview.scheme.get()&&((c=document.createElement("a")).href=o.url,c.protocol="https:",o.url=c.href,c.href=u.url,c.protocol="https:",u.url=c.href),n.title&&(delete u.original_title,delete o.original_title),l.isEqual(u,o)))return!1;if(a.params.navMenuArgs.theme_location){if("nav_menu_locations["+a.params.navMenuArgs.theme_location+"]"===e.id)return!0;i=v("nav_menu_locations["+a.params.navMenuArgs.theme_location+"]")}return!(r=a.params.navMenuArgs.menu)&&i&&(r=i()),!!r&&("nav_menu["+r+"]"===e.id||s&&(n&&n.nav_menu_term_id===r||t&&t.nav_menu_term_id===r))},refresh:function(){var e=this,n,t=a.Deferred();return l.isNumber(e.params.navMenuArgs.menu)?n=e.params.navMenuArgs.menu:e.params.navMenuArgs.theme_location&&v.has("nav_menu_locations["+e.params.navMenuArgs.theme_location+"]")&&(n=v("nav_menu_locations["+e.params.navMenuArgs.theme_location+"]").get()),n?v.selectiveRefresh.Partial.prototype.refresh.call(e):(e.fallback(),t.reject(),t.promise())},renderContent:function(e){var n=this,t=e.container;""===e.addedContent&&e.partial.fallback(),v.selectiveRefresh.Partial.prototype.renderContent.call(n,e)&&a(document).trigger("customize-preview-menu-refreshed",[{instanceNumber:null,wpNavArgs:e.context,wpNavMenuArgs:e.context,oldContainer:t,newContainer:e.container}])}}),v.selectiveRefresh.partialConstructor.nav_menu_instance=i.NavMenuInstancePartial,i.handleUnplacedNavMenuInstances=function(e){var n;return n=l.filter(l.values(i.data.navMenuInstanceArgs),function(e){return!v.selectiveRefresh.partial.has("nav_menu_instance["+e.args_hmac+"]")}),!!l.findWhere(n,e)&&(v.selectiveRefresh.requestFullRefresh(),!0)},i.bindSettingListener=function(e,n){var t;return n=n||{},(t=e.id.match(/^nav_menu\[(-?\d+)]$/))?(e._navMenuId=parseInt(t[1],10),e.bind(this.onChangeNavMenuSetting),n.fire&&this.onChangeNavMenuSetting.call(e,e(),!1),!0):(t=e.id.match(/^nav_menu_item\[(-?\d+)]$/))?(e._navMenuItemId=parseInt(t[1],10),e.bind(this.onChangeNavMenuItemSetting),n.fire&&this.onChangeNavMenuItemSetting.call(e,e(),!1),!0):!!(t=e.id.match(/^nav_menu_locations\[(.+?)]/))&&(e._navMenuThemeLocation=t[1],e.bind(this.onChangeNavMenuLocationsSetting),n.fire&&this.onChangeNavMenuLocationsSetting.call(e,e(),!1),!0)},i.unbindSettingListener=function(e){e.unbind(this.onChangeNavMenuSetting),e.unbind(this.onChangeNavMenuItemSetting),e.unbind(this.onChangeNavMenuLocationsSetting)},i.onChangeNavMenuSetting=function(){var n=this;i.handleUnplacedNavMenuInstances({menu:n._navMenuId}),v.each(function(e){e._navMenuThemeLocation&&n._navMenuId===e()&&i.handleUnplacedNavMenuInstances({theme_location:e._navMenuThemeLocation})})},i.onChangeNavMenuItemSetting=function(e,n){var t,a;(a=v("nav_menu["+String((e||n).nav_menu_term_id)+"]"))&&i.onChangeNavMenuSetting.call(a)},i.onChangeNavMenuLocationsSetting=function(){var e=this,n;i.handleUnplacedNavMenuInstances({theme_location:e._navMenuThemeLocation}),(n=!!l.findWhere(l.values(i.data.navMenuInstanceArgs),{theme_location:e._navMenuThemeLocation}))||v.selectiveRefresh.requestFullRefresh()}),i.highlightControls=function(){var e=".menu-item";v.settings.channel&&a(document).on("click",e,function(e){var n;e.shiftKey&&(n=a(this).attr("class").match(/(?:^|\s)menu-item-(-?\d+)(?:\s|$)/))&&(e.preventDefault(),e.stopPropagation(),v.preview.send("focus-nav-menu-item-control",parseInt(n[1],10)))})},v.bind("preview-ready",function(){i.init()}),i}(jQuery,_,wp,wp.customize);