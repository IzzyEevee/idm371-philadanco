!function(F,T,x){var e=function(){function e(){var e,n,t,a;"string"==typeof T.pagenow&&(k.screenId=T.pagenow),"string"==typeof T.ajaxurl&&(k.url=T.ajaxurl),"object"==typeof T.heartbeatSettings&&(e=T.heartbeatSettings,!k.url&&e.ajaxurl&&(k.url=e.ajaxurl),e.interval&&(k.mainInterval=e.interval,k.mainInterval<15?k.mainInterval=15:120<k.mainInterval&&(k.mainInterval=120)),e.minimalInterval&&(e.minimalInterval=parseInt(e.minimalInterval,10),k.minimalInterval=0<e.minimalInterval&&e.minimalInterval<=600?1e3*e.minimalInterval:0),k.minimalInterval&&k.mainInterval<k.minimalInterval&&(k.mainInterval=k.minimalInterval),k.screenId||(k.screenId=e.screenId||"front"),"disable"===e.suspension&&(k.suspendEnabled=!1)),k.mainInterval=1e3*k.mainInterval,k.originalInterval=k.mainInterval,void 0!==document.hidden?(n="hidden",a="visibilitychange",t="visibilityState"):void 0!==document.msHidden?(n="msHidden",a="msvisibilitychange",t="msVisibilityState"):void 0!==document.webkitHidden&&(n="webkitHidden",a="webkitvisibilitychange",t="webkitVisibilityState"),n&&(document[n]&&(k.hasFocus=!1),y.on(a+".wp-heartbeat",function(){"hidden"===document[t]?(s(),T.clearInterval(k.checkFocusTimer)):(l(),document.hasFocus&&(k.checkFocusTimer=T.setInterval(i,1e4)))})),document.hasFocus&&(k.checkFocusTimer=T.setInterval(i,1e4)),F(T).on("unload.wp-heartbeat",function(){k.suspend=!0,k.xhr&&4!==k.xhr.readyState&&k.xhr.abort()}),T.setInterval(m,3e4),y.ready(function(){k.lastTick=r(),u()})}function r(){return(new Date).getTime()}function t(e){var n,t=e.src;if(t&&/^https?:\/\//.test(t)&&(n=T.location.origin?T.location.origin:T.location.protocol+"//"+T.location.host,0!==t.indexOf(n)))return!1;try{if(e.contentWindow.document)return!0}catch(e){}return!1}function i(){k.hasFocus&&!document.hasFocus()?s():!k.hasFocus&&document.hasFocus()&&l()}function o(e,n){var t;if(e){switch(e){case"abort":break;case"timeout":t=!0;break;case"error":if(503===n&&k.hasConnected){t=!0;break}case"parsererror":case"empty":case"unknown":k.errorcount++,2<k.errorcount&&k.hasConnected&&(t=!0)}t&&!d()&&(k.connectionError=!0,y.trigger("heartbeat-connection-lost",[e,n]))}}function c(){k.hasConnected=!0,d()&&(k.errorcount=0,k.connectionError=!1,y.trigger("heartbeat-connection-restored"))}function a(){var e,n;k.connecting||k.suspend||(k.lastTick=r(),n=F.extend({},k.queue),k.queue={},y.trigger("heartbeat-send",[n]),e={data:n,interval:k.tempInterval?k.tempInterval/1e3:k.mainInterval/1e3,_nonce:"object"==typeof T.heartbeatSettings?T.heartbeatSettings.nonce:"",action:"heartbeat",screen_id:k.screenId,has_focus:k.hasFocus},"customize"===k.screenId&&(e.wp_customize="on"),k.connecting=!0,k.xhr=F.ajax({url:k.url,type:"post",timeout:3e4,data:e,dataType:"json"}).always(function(){k.connecting=!1,u()}).done(function(e,n,t){var a;return e?(c(),e.nonces_expired&&y.trigger("heartbeat-nonces-expired"),e.heartbeat_interval&&(a=e.heartbeat_interval,delete e.heartbeat_interval),y.trigger("heartbeat-tick",[e,n,t]),void(a&&p(a))):void o("empty")}).fail(function(e,n,t){o(n||"unknown",e.status),y.trigger("heartbeat-error",[e,n,t])}))}function u(){var e=r()-k.lastTick,n=k.mainInterval;k.suspend||(k.hasFocus?0<k.countdown&&k.tempInterval&&(n=k.tempInterval,k.countdown--,k.countdown<1&&(k.tempInterval=0)):n=12e4,k.minimalInterval&&n<k.minimalInterval&&(n=k.minimalInterval),T.clearTimeout(k.beatTimer),e<n?k.beatTimer=T.setTimeout(function(){a()},n-e):a())}function s(){k.hasFocus=!1}function l(){k.userActivity=r(),k.suspend=!1,k.hasFocus||(k.hasFocus=!0,u())}function v(){k.userActivityEvents=!1,y.off(".wp-heartbeat-active"),F("iframe").each(function(e,n){t(n)&&F(n.contentWindow).off(".wp-heartbeat-active")}),l()}function m(){var e=k.userActivity?r()-k.userActivity:0;3e5<e&&k.hasFocus&&s(),(k.suspendEnabled&&6e5<e||36e5<e)&&(k.suspend=!0),k.userActivityEvents||(y.on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active",function(){v()}),F("iframe").each(function(e,n){t(n)&&F(n.contentWindow).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active",function(){v()})}),k.userActivityEvents=!0)}function n(){return k.hasFocus}function d(){return k.connectionError}function h(){k.lastTick=0,u()}function I(){k.suspendEnabled=!1}function p(e,n){var t,a=k.tempInterval?k.tempInterval:k.mainInterval;if(e){switch(e){case"fast":case 5:t=5e3;break;case 15:t=15e3;break;case 30:t=3e4;break;case 60:t=6e4;break;case 120:t=12e4;break;case"long-polling":return k.mainInterval=0;default:t=k.originalInterval}k.minimalInterval&&t<k.minimalInterval&&(t=k.minimalInterval),5e3===t?(n=(n=parseInt(n,10)||30)<1||30<n?30:n,k.countdown=n,k.tempInterval=t):(k.countdown=0,k.tempInterval=0,k.mainInterval=t),t!==a&&u()}return k.tempInterval?k.tempInterval/1e3:k.mainInterval/1e3}function f(e,n,t){return!(!e||t&&this.isQueued(e)||(k.queue[e]=n,0))}function b(e){if(e)return k.queue.hasOwnProperty(e)}function w(e){e&&delete k.queue[e]}function g(e){if(e)return this.isQueued(e)?k.queue[e]:x}var y=F(document),k={suspend:!1,suspendEnabled:!0,screenId:"",url:"",lastTick:0,queue:{},mainInterval:60,tempInterval:0,originalInterval:0,minimalInterval:0,countdown:0,connecting:!1,connectionError:!1,errorcount:0,hasConnected:!1,hasFocus:!0,userActivity:0,userActivityEvents:!1,checkFocusTimer:0,beatTimer:0};return e(),{hasFocus:n,connectNow:h,disableSuspend:I,interval:p,hasConnectionError:d,enqueue:f,dequeue:w,isQueued:b,getQueuedItem:g}};T.wp=T.wp||{},T.wp.heartbeat=new e}(jQuery,window);